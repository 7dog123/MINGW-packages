_realname=genromfs
pkgbase=mingw-w64-${_realname}
pkgname=("${MINGW_PACKAGE_PREFIX}-${_realname}")
pkgver=0.5.2
pkgrel=1
pkgdesc="Creates ROMFS images"
arch=('any')
mingw_arch=('mingw32' 'mingw64' 'ucrt64' 'clang32')
url="https://romfs.sourceforge.net/"
license=("GPL+2")
makedepends=("${MINGW_PACKAGE_PREFIX}-gcc")
source=("${_realname}-${pkgver}.tar.gz::https://github.com/chexum/${_realname}/archive/refs/tags/${pkgver}.tar.gz"
        "0001-build-mingw.patch")
sha256sums=('a96953ff6a2ce96b9c9aca99faaa43fda0e25e0012f3855cd6b988a12895467b'
            '7bbade790aa09cda19164926895ff77a3807d27f6a3d159402fcaeaa2d916f03')

prepare() {
  cd "${srcdir}"/${_realname}-${pkgver}

  patch -Np1 -i "${srcdir}/0001-build-mingw.patch"
}

build() {
  cd "${srcdir}"/${_realname}-${pkgver}
  make
}

package() {
  cd "${srcdir}"/${_realname}-${pkgver}
  make PREFIX="${pkgdir}/${MINGW_PREFIX}" install
}
